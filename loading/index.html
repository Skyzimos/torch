<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<link href="/torch/loading/style.css" rel="stylesheet" type="text/css" />
</head>

<body>

	<svg class="pl" width="240" height="240" viewBox="0 0 240 240">
		<circle class="pl__ring pl__ring--a" cx="120" cy="120" r="105" fill="none" stroke="#000" stroke-width="20"
			stroke-dasharray="0 660" stroke-dashoffset="-330" stroke-linecap="round"></circle>
		<circle class="pl__ring pl__ring--b" cx="120" cy="120" r="35" fill="none" stroke="#000" stroke-width="20"
			stroke-dasharray="0 220" stroke-dashoffset="-110" stroke-linecap="round"></circle>
		<circle class="pl__ring pl__ring--c" cx="85" cy="120" r="70" fill="none" stroke="#000" stroke-width="20"
			stroke-dasharray="0 440" stroke-linecap="round"></circle>
		<circle class="pl__ring pl__ring--d" cx="155" cy="120" r="70" fill="none" stroke="#000" stroke-width="20"
			stroke-dasharray="0 440" stroke-linecap="round"></circle>
	</svg>

	<h3>
		Powered by <span
			style="color: #606060; font-size: 1.1em; font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; font-weight: 700;">Torch</span>
	</h3>

	<script>
		let prefix = '/torch/';

		window.onload = function () {
			const redirectRules = [
				{ key: 'processing', clear: true, delay: 2000, path: 'processing-transaction/' },
				{ key: 'complete', clear: true, delay: 1500, path: 'transaction-complete/' },
				{ key: 'selection-menu', clear: true, delay: 1500, path: 'kiosk-selection/' },
				{ key: 'finalize', clear: 'single', delay: 1000, path: '' },
				{ key: 'time', clear: false, delay: 1500, path: 'selection-menu/' },
				{ key: 'ticket_verification', clear: false, delay: 2000, path: 'seat/' },
				{ key: 'ticket_verification_complete', clear: 'single', delay: 1750, path: 'seat-verification/' },
				{ key: 'get_tickets', clear: 'single', delay: 1500, path: 'time-selection/' },
				{ key: 'check_ticket_show_time', clear: 'single', delay: 1500, path: 'check-ticket-show-time/' },
				{ key: 'ticket_showtime_verification', clear: false, delay: 2000, path: 'check-ticket-show-time/ticket-time/' },
				{ key: 'ticket_showtime_verification_complete', clear: 'single', delay: 1000, path: 'menu/' },
				{ key: 'usher_mode', clear: 'single', delay: 500, path: 'seat-verification/' }
			];

			let matched = false;

			for (const rule of redirectRules) {
				if (sessionStorage.getItem(rule.key)) {
					matched = true;

					if (rule.clear === true) {
						sessionStorage.clear();
					} else if (rule.clear === 'single') {
						sessionStorage.removeItem(rule.key);
					}

					setTimeout(() => {
						window.location.href = `${prefix}${rule.path}`;
					}, rule.delay);

					break;
				}
			}

			if (!matched) {
				setTimeout(() => {
					window.location.href = `${prefix}menu/`;
				}, 1500);
			}
		};
	</script>
</body>

</html>